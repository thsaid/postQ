---
title: "PostCC_IRT"
author: "Tamer Said"
date: "15/06/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ltm)
library(mirt)
library(tidyverse)
library(polycor)
library(lavaan)
library(dplyr) 
library(tidyr)
library(psych)
library(mirt)
library(ltm)
library(ggpubr)
```

Recoding values for Q09Post 

```{r}
PostCC2 <- PostCC %>% mutate(Q09Post = case_when(
PostCC$Q09post == 3 ~ c("Not Sure"),
PostCC$Q09post == 4 ~ c("Agree"),
PostCC$Q09post == 2 ~ c("Disagree")))
```

Recoding values for Q14Post 
```{r}
PostCC2 <- PostCC2 %>% mutate(Q14Post = case_when(
PostCC$Q14post == 3 ~ c("Not Sure"),
PostCC$Q14post == 4 ~ c("Agree"),
PostCC$Q14post == 2 ~ c("Disagree")))
```

Reading the modified file
```{r}
PostCC <- read.csv("PostCC.csv")
```

Selecting the relevant coloumns 

```{r}
PostCC <-select(PostCC, ID:Q14Post, -Q09post, -Q14post)
```

```{r}
spread(PostCCscores, Question, value)
```
De-selecting the responses to avoid confusion

```{r}
PostCCscoresNew <- select(PostCCscores, - Response)
```

```{r}
PostCC_Wide <- PostCCscoresNew  %>%
pivot_wider(names_from = Question, values_from = value)
```

#Examining the binary questions (excluding Q20, 21, 22)

```{r}
PostCCIRT <- dplyr::select(PostCCScore_Wide, -ID, -Q20post, -Q21post, -Q22post)
```

```{r}
describe(PostCCIRT)
```
#To do , after joinng the pre table, do a description like this to have a table of the pre and post values and compare the means and SD of each question. 

```{r}
IRTpostmodel = ltm(PostCCIRT~z1, IRT.param = TRUE, na.action = na.exclude)#na exclude command, excludes missing values
IRTpostmodel
```
#ICC Curves
```{r}
plot(IRTpostmodel, type = "ICC") ## all items at once "Item Characterisitc Curve"
```


Merging data from pre and post 

The data needs to be joined first in the long format, then converted to wide format, where each student (ID) has a row for pre data and post data. 

loading preCC wide

```{r}
PreCC_Wide <- read.csv("PreCCWide.csv")
```


#Merging data from pre and post 
```{r}
PrePostCC_Wide <- merge(PreCC_Wide,PostCC_Wide)
```

For analysis, removng ID and X

```{r}

```

```{r}
CompDescriptives <- describe(PrePostCC_Wide)
```

Doing GPCM for the whole set of questions to see the difference between the two scores, then will filter out the polynomial items


